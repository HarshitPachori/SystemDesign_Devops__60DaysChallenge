---
title: "Day 31: AWS Cloudfront"
description: "A summary of my 31th day's learning in the 60-day challenge, covering basic concepts of Cloudfront."
keywords:
  - AWS
  - Cloudfront
  - Day 31
  - Challenge
---

### Table of contents :
- [How to create Custom Error page on Cloudfront ?](#how-to-create-custom-error-page-on-cloudfront-)


### How to create Custom Error page on Cloudfront ?
To create custom error pages in CloudFront, you configure your CloudFront distribution to serve a specific file (your custom error page) when certain HTTP error codes are returned from your origin or generated by CloudFront itself. This allows you to provide a more user-friendly experience than the default CloudFront error page or a raw error from your origin.

- **Why Use Custom Error Pages?**
  - **Improved User Experience**: Instead of generic error messages, you can display branded, helpful pages that guide users or provide relevant information (e.g., "Page Not Found," "Service Unavailable").

  - **Branding Consistency**: Maintain your website's look and feel even when errors occur.

  - **Guidance**: Direct users back to the homepage, provide contact information, or suggest alternative actions.

  - **SEO Benefits**: For 404 errors, a well-designed custom page can help retain users and prevent them from leaving your site entirely.

- **How CloudFront Custom Error Pages Work**
When CloudFront receives an HTTP status code that you've configured a custom error page for (e.g., 404 Not Found, 500 Internal Server Error), it does the following:

  - **Fetches the Custom Error Page**: CloudFront retrieves the specified custom error page (e.g., /404.html, /error.html) from its origin.

  - **Changes Response Code (Optional but common)**: It can change the HTTP status code returned to the viewer (e.g., change a 500 from the origin to a 200 OK for the custom page, while still returning the original 500 to the browser).

  - **Caches the Error Page**: The custom error page is cached at edge locations based on its configured TTL.

- **Steps to Create a Custom Error Page in CloudFront**
Let's assume you have an S3 bucket as an origin for your static website, and you want to serve a custom 404.html page for 404 errors.

- **Step 1: Create Your Custom Error Page in Your Origin**
First, create the HTML file for your custom error page and upload it to your origin (e.g., your S3 bucket).

  - **Create 404.html (or error.html)**:

    ```HTML

      <!DOCTYPE html>
      <html lang="en">
      <head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <title>Page Not Found - My Website</title>
          <style>
              body { font-family: Arial, sans-serif; text-align: center; padding: 50px; }
              h1 { color: #f00; }
              p { color: #555; }
              a { color: #007bff; text-decoration: none; }
          </style>
      </head>
      <body>
          <h1>404 - Page Not Found</h1>
          <p>Oops! The page you are looking for might have been removed, had its name changed, or is temporarily unavailable.</p>
          <p>Please try going back to the <a href="/">homepage</a>.</p>
      </body>
      </html>
    ```

  - **Upload to S3**: Upload this 404.html file to the root of your S3 bucket that serves as your CloudFront origin. Ensure it's accessible by CloudFront (e.g., via OAC).

- **Step 2: Configure CloudFront Custom Error Responses**
  - **Sign in to the AWS Management Console**: Go to https://aws.amazon.com/console/ and sign in.

  - **Navigate to CloudFront**: Search for "CloudFront" and select the service.

  - **Select Your Distribution**: Click on the ID of the distribution you want to configure.

  - **Go to the "Error Pages" Tab**: In the distribution details, click on the "Error Pages" tab.

  - **Create Custom Error Response**: Click the "Create Custom Error Response" button.

  - **Configure the Error Response**:

    - **HTTP Error Code**: Select the HTTP status code that CloudFront will respond to.

      - For a "Page Not Found" error, select 404 Not Found.

      - You can also configure for 500 Internal Server Error, 502 Bad Gateway, 503 Service Unavailable, 504 Gateway Timeout, etc.

    - **Customize Error Response**: Select Yes.

    - **Response Page Path**: Enter the path to your custom error page in your origin. This path must start with a /.

      - **Example**: /404.html

    - **HTTP Response Code**: This is the HTTP status code that CloudFront will return to the viewer's browser.

      - For a 404 error, it's best practice to keep this as 404 Not Found so search engines understand the page is genuinely missing.

      - For server errors (5xx), you might choose to return 500 Internal Server Error or even 200 OK if you want the browser to treat the custom page as a successful response (though 5xx is generally preferred for server issues).

    - **Error Caching Minimum TTL (seconds)**: This specifies how long CloudFront should cache the custom error page for this error code.

      - A short TTL (e.g., 10 seconds) is good for dynamic errors (like 5xx) so that if the origin recovers quickly, users see the correct content soon.

      - For 404s, a longer TTL (e.g., 300 seconds or more) might be acceptable as missing pages are less likely to suddenly appear.

    - **Create**: Click "Create".

- **Step 3: Wait for Deployment and Test**
  - **Monitor Distribution Status**: Your CloudFront distribution status will change to "Deploying". Wait until it shows "Deployed". This can take 5-15 minutes.

  - **Test Your Custom Error Page**:

    - **For 404 errors**: Try accessing a non-existent URL on your CloudFront distribution (e.g., https://your-cloudfront-domain.com/non-existent-page.html). You should see your custom 404.html page.

    - **For 5xx errors**: You might need to intentionally cause a server error on your origin to test these (e.g., temporarily shut down your web server or make an API endpoint return a 500).

- **Important Considerations**:
  - **Path to Error Page**: The Response Page Path refers to the path relative to your origin's root. If your 404.html is in a subdirectory like /errors/404.html, then that's what you'd enter.

  - **Origin Accessibility**: The custom error page file must be accessible by CloudFront from its origin. If your S3 bucket is private, ensure your OAC (Origin Access Control) is correctly configured to allow CloudFront to fetch this specific error page.

  - **HTTP Response Code for Viewer**: Carefully consider the HTTP Response Code you return to the viewer.

    - Returning the original error code (e.g., 404 for a 404 error) is generally best for SEO and proper client-side handling.

    - Changing a 5xx error to a 200 OK for the custom error page can hide the underlying server issue from the client, but it might also prevent monitoring tools from accurately detecting server problems.

  - **Caching of Error Pages**: CloudFront caches error responses just like regular content. The TTL you set for the error page is crucial. If an origin starts returning errors, CloudFront will cache that error for the specified TTL, potentially showing the error page even after the origin recovers. Adjust the TTL based on how quickly you expect your origin to recover from issues.

  - **Multiple Error Pages**: You can configure different custom error pages for different HTTP error codes (e.g., one for 404, another for 500).


